{"ast":null,"code":"var _jsxFileName = \"D:\\\\Sathipasala\\\\sathipasala-management-system\\\\frontend\\\\src\\\\pages\\\\admin\\\\StudentAttendance.jsx\",\n  _s = $RefreshSig$();\nimport { useState, useEffect } from 'react';\nimport { useParams, Link } from 'react-router-dom';\nimport { useTranslation } from 'react-i18next';\nimport axios from 'axios';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst StudentAttendance = () => {\n  _s();\n  const {\n    studentId\n  } = useParams();\n  const {\n    t\n  } = useTranslation();\n  const [student, setStudent] = useState(null);\n  const [attendanceHistory, setAttendanceHistory] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n  const [filters, setFilters] = useState({\n    startDate: new Date(new Date().getFullYear(), 0, 1).toISOString().split('T')[0],\n    // Jan 1st of current year\n    endDate: new Date().toISOString().split('T')[0] // Today\n  });\n  useEffect(() => {\n    const fetchStudentData = async () => {\n      try {\n        setLoading(true);\n\n        // Fetch student details\n        const studentResponse = await axios.get(`/api/students/${studentId}`, {\n          headers: {\n            Authorization: `Bearer ${localStorage.getItem('token')}`\n          }\n        });\n        setStudent(studentResponse.data.data);\n\n        // Fetch attendance history\n        const attendanceResponse = await axios.get(`/api/attendance/student/${studentId}?startDate=${filters.startDate}&endDate=${filters.endDate}`, {\n          headers: {\n            Authorization: `Bearer ${localStorage.getItem('token')}`\n          }\n        });\n\n        // If API doesn't return data yet, generate mock data for development\n        if (!attendanceResponse.data || !attendanceResponse.data.data) {\n          const mockData = generateMockAttendanceData(filters.startDate, filters.endDate);\n          setAttendanceHistory(mockData);\n        } else {\n          setAttendanceHistory(attendanceResponse.data.data);\n        }\n      } catch (error) {\n        var _error$response, _error$response$data;\n        console.error('Error fetching student data:', error);\n        setError(((_error$response = error.response) === null || _error$response === void 0 ? void 0 : (_error$response$data = _error$response.data) === null || _error$response$data === void 0 ? void 0 : _error$response$data.message) || 'Failed to load student data');\n\n        // Generate mock data for development\n        const mockStudent = {\n          _id: studentId,\n          studentId: 'SATHI-2023-A-001',\n          name: {\n            en: 'Sample Student',\n            si: 'නියැදි සිසුවා'\n          },\n          dateOfBirth: '2015-05-15',\n          ageGroup: '7-10',\n          classYear: '2023',\n          classCode: 'A',\n          parentInfo: {\n            name: {\n              en: 'Parent Name',\n              si: 'දෙමාපිය නම'\n            },\n            phone: '0771234567',\n            email: 'parent@example.com'\n          }\n        };\n        setStudent(mockStudent);\n        const mockData = generateMockAttendanceData(filters.startDate, filters.endDate);\n        setAttendanceHistory(mockData);\n      } finally {\n        setLoading(false);\n      }\n    };\n    fetchStudentData();\n  }, [studentId, filters.startDate, filters.endDate]);\n\n  // Generate mock attendance data for development\n  const generateMockAttendanceData = (startDate, endDate) => {\n    const start = new Date(startDate);\n    const end = new Date(endDate);\n    const attendanceData = [];\n    const currentDate = new Date(start);\n    while (currentDate <= end) {\n      // Only include Sundays\n      if (currentDate.getDay() === 0) {\n        // Random attendance status\n        const random = Math.random();\n        let status;\n        let reason = '';\n        if (random < 0.75) {\n          status = 'present';\n        } else if (random < 0.9) {\n          status = 'absent';\n          reason = 'Sick leave';\n        } else {\n          status = 'late';\n          reason = 'Traffic delay';\n        }\n        attendanceData.push({\n          date: new Date(currentDate).toISOString().split('T')[0],\n          status,\n          reason\n        });\n      }\n\n      // Move to next day\n      currentDate.setDate(currentDate.getDate() + 1);\n    }\n    return attendanceData;\n  };\n  const handleFilterChange = e => {\n    const {\n      name,\n      value\n    } = e.target;\n    setFilters(prev => ({\n      ...prev,\n      [name]: value\n    }));\n  };\n\n  // Calculate statistics\n  const calculateStats = () => {\n    const total = attendanceHistory.length;\n    const present = attendanceHistory.filter(item => item.status === 'present').length;\n    const absent = attendanceHistory.filter(item => item.status === 'absent').length;\n    const late = attendanceHistory.filter(item => item.status === 'late').length;\n    const presentRate = total > 0 ? (present / total * 100).toFixed(1) : 0;\n    const absentRate = total > 0 ? (absent / total * 100).toFixed(1) : 0;\n    const lateRate = total > 0 ? (late / total * 100).toFixed(1) : 0;\n    return {\n      total,\n      present,\n      absent,\n      late,\n      presentRate,\n      absentRate,\n      lateRate\n    };\n  };\n  const stats = calculateStats();\n  const handleExportCSV = () => {\n    if (!student) return;\n\n    // Create CSV content\n    const headers = \"Date,Status,Reason\\n\";\n    const rows = attendanceHistory.map(item => `${item.date},${item.status},${item.reason || ''}`).join('\\n');\n    const csvContent = headers + rows;\n    const blob = new Blob([csvContent], {\n      type: 'text/csv;charset=utf-8;'\n    });\n    const url = URL.createObjectURL(blob);\n    const link = document.createElement('a');\n    link.setAttribute('href', url);\n    link.setAttribute('download', `${student.studentId}-attendance.csv`);\n    link.style.visibility = 'hidden';\n    document.body.appendChild(link);\n    link.click();\n    document.body.removeChild(link);\n  };\n  if (loading) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex justify-center items-center h-full\",\n      children: \"Loading...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 181,\n      columnNumber: 12\n    }, this);\n  }\n  if (error) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"p-6 bg-red-100 text-red-700 dark:bg-red-900 dark:text-red-300 rounded\",\n      children: error\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 186,\n      columnNumber: 7\n    }, this);\n  }\n  if (!student) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"p-6 bg-yellow-100 text-yellow-700 dark:bg-yellow-900 dark:text-yellow-300 rounded\",\n      children: t('admin.students.studentNotFound')\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 194,\n      columnNumber: 7\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"space-y-6\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"bg-white dark:bg-gray-800 rounded-lg shadow p-6\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex flex-col md:flex-row md:items-center md:justify-between mb-6\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n            className: \"text-xl font-semibold text-gray-900 dark:text-white\",\n            children: t('admin.attendance.studentAttendance')\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 205,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-gray-600 dark:text-gray-400\",\n            children: [student.name.en, \" (\", student.studentId, \")\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 208,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 204,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"mt-4 md:mt-0\",\n          children: /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: handleExportCSV,\n            className: \"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 transition-colors\",\n            children: t('admin.export.csv')\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 214,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 213,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 203,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bg-blue-50 dark:bg-blue-900 p-4 rounded-lg mb-6\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n              className: \"text-sm font-medium text-gray-700 dark:text-gray-300\",\n              children: t('admin.students.name')\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 227,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"text-base font-medium text-gray-900 dark:text-white\",\n              children: student.name.en\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 230,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"text-sm text-gray-500 dark:text-gray-400\",\n              children: student.name.si\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 233,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 226,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n              className: \"text-sm font-medium text-gray-700 dark:text-gray-300\",\n              children: t('admin.students.class')\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 239,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"text-base font-medium text-gray-900 dark:text-white\",\n              children: [student.classYear, \"-\", student.classCode]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 242,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"text-sm text-gray-500 dark:text-gray-400\",\n              children: [student.ageGroup, \" \", t('admin.students.years')]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 245,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 238,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n              className: \"text-sm font-medium text-gray-700 dark:text-gray-300\",\n              children: t('admin.students.dateOfBirth')\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 251,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"text-base font-medium text-gray-900 dark:text-white\",\n              children: new Date(student.dateOfBirth).toLocaleDateString()\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 254,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 250,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n              className: \"text-sm font-medium text-gray-700 dark:text-gray-300\",\n              children: t('admin.students.contact')\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 260,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"text-base font-medium text-gray-900 dark:text-white\",\n              children: student.parentInfo.phone\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 263,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"text-sm text-gray-500 dark:text-gray-400\",\n              children: student.parentInfo.name.en\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 266,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 259,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 225,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 224,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            className: \"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\",\n            children: t('admin.attendance.startDate')\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 276,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"date\",\n            name: \"startDate\",\n            value: filters.startDate,\n            onChange: handleFilterChange,\n            className: \"w-full px-3 py-2 border rounded focus:outline-none focus:ring focus:border-blue-300 dark:bg-gray-700 dark:text-white dark:border-gray-600\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 279,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 275,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            className: \"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\",\n            children: t('admin.attendance.endDate')\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 289,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"date\",\n            name: \"endDate\",\n            value: filters.endDate,\n            onChange: handleFilterChange,\n            className: \"w-full px-3 py-2 border rounded focus:outline-none focus:ring focus:border-blue-300 dark:bg-gray-700 dark:text-white dark:border-gray-600\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 292,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 288,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 274,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"bg-green-50 dark:bg-green-900 p-4 rounded-lg\",\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            className: \"text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\",\n            children: t('admin.attendance.present')\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 305,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-lg font-semibold text-green-800 dark:text-green-200\",\n            children: [stats.present, \" (\", stats.presentRate, \"%)\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 308,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 304,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"bg-yellow-50 dark:bg-yellow-900 p-4 rounded-lg\",\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            className: \"text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\",\n            children: t('admin.attendance.absent')\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 314,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-lg font-semibold text-yellow-800 dark:text-yellow-200\",\n            children: [stats.absent, \" (\", stats.absentRate, \"%)\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 317,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 313,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"bg-red-50 dark:bg-red-900 p-4 rounded-lg\",\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            className: \"text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\",\n            children: t('admin.attendance.late')\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 323,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-lg font-semibold text-red-800 dark:text-red-200\",\n            children: [stats.late, \" (\", stats.lateRate, \"%)\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 326,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 322,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 303,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"overflow-x-auto rounded-lg shadow\",\n        children: /*#__PURE__*/_jsxDEV(\"table\", {\n          className: \"min-w-full bg-white dark:bg-gray-800\",\n          children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n            className: \"bg-gray-100 dark:bg-gray-700\",\n            children: /*#__PURE__*/_jsxDEV(\"tr\", {\n              children: [/*#__PURE__*/_jsxDEV(\"th\", {\n                className: \"px-4 py-2 text-left text-sm font-medium text-gray-700 dark:text-gray-300\",\n                children: t('admin.attendance.date')\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 337,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                className: \"px-4 py-2 text-left text-sm font-medium text-gray-700 dark:text-gray-300\",\n                children: t('admin.attendance.status')\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 340,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                className: \"px-4 py-2 text-left text-sm font-medium text-gray-700 dark:text-gray-300\",\n                children: t('admin.attendance.reason')\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 343,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 336,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 335,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n            className: \"divide-y divide-gray-200 dark:divide-gray-700\",\n            children: attendanceHistory.map(item => /*#__PURE__*/_jsxDEV(\"tr\", {\n              children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                className: \"px-4 py-2 text-sm text-gray-900 dark:text-white\",\n                children: new Date(item.date).toLocaleDateString()\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 352,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                className: \"px-4 py-2 text-sm\",\n                children: /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: `inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${item.status === 'present' ? 'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300' : item.status === 'absent' ? 'bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300' : 'bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300'}`,\n                  children: t(`admin.attendance.${item.status}`)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 356,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 355,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                className: \"px-4 py-2 text-sm text-gray-900 dark:text-white\",\n                children: item.reason || '-'\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 368,\n                columnNumber: 19\n              }, this)]\n            }, item.date, true, {\n              fileName: _jsxFileName,\n              lineNumber: 351,\n              columnNumber: 17\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 349,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 334,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 333,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 202,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 201,\n    columnNumber: 5\n  }, this);\n};\n_s(StudentAttendance, \"y9eu5VfNBTqh5rVNhO3q7YHG1EY=\", false, function () {\n  return [useParams, useTranslation];\n});\n_c = StudentAttendance;\nexport default StudentAttendance;\nvar _c;\n$RefreshReg$(_c, \"StudentAttendance\");","map":{"version":3,"names":["useState","useEffect","useParams","Link","useTranslation","axios","jsxDEV","_jsxDEV","StudentAttendance","_s","studentId","t","student","setStudent","attendanceHistory","setAttendanceHistory","loading","setLoading","error","setError","filters","setFilters","startDate","Date","getFullYear","toISOString","split","endDate","fetchStudentData","studentResponse","get","headers","Authorization","localStorage","getItem","data","attendanceResponse","mockData","generateMockAttendanceData","_error$response","_error$response$data","console","response","message","mockStudent","_id","name","en","si","dateOfBirth","ageGroup","classYear","classCode","parentInfo","phone","email","start","end","attendanceData","currentDate","getDay","random","Math","status","reason","push","date","setDate","getDate","handleFilterChange","e","value","target","prev","calculateStats","total","length","present","filter","item","absent","late","presentRate","toFixed","absentRate","lateRate","stats","handleExportCSV","rows","map","join","csvContent","blob","Blob","type","url","URL","createObjectURL","link","document","createElement","setAttribute","style","visibility","body","appendChild","click","removeChild","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onClick","toLocaleDateString","onChange","_c","$RefreshReg$"],"sources":["D:/Sathipasala/sathipasala-management-system/frontend/src/pages/admin/StudentAttendance.jsx"],"sourcesContent":["import { useState, useEffect } from 'react';\r\nimport { useParams, Link } from 'react-router-dom';\r\nimport { useTranslation } from 'react-i18next';\r\nimport axios from 'axios';\r\n\r\nconst StudentAttendance = () => {\r\n  const { studentId } = useParams();\r\n  const { t } = useTranslation();\r\n  const [student, setStudent] = useState(null);\r\n  const [attendanceHistory, setAttendanceHistory] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState(null);\r\n  \r\n  const [filters, setFilters] = useState({\r\n    startDate: new Date(new Date().getFullYear(), 0, 1).toISOString().split('T')[0], // Jan 1st of current year\r\n    endDate: new Date().toISOString().split('T')[0], // Today\r\n  });\r\n\r\n  useEffect(() => {\r\n    const fetchStudentData = async () => {\r\n      try {\r\n        setLoading(true);\r\n        \r\n        // Fetch student details\r\n        const studentResponse = await axios.get(`/api/students/${studentId}`, {\r\n          headers: {\r\n            Authorization: `Bearer ${localStorage.getItem('token')}`\r\n          }\r\n        });\r\n        \r\n        setStudent(studentResponse.data.data);\r\n        \r\n        // Fetch attendance history\r\n        const attendanceResponse = await axios.get(\r\n          `/api/attendance/student/${studentId}?startDate=${filters.startDate}&endDate=${filters.endDate}`,\r\n          {\r\n            headers: {\r\n              Authorization: `Bearer ${localStorage.getItem('token')}`\r\n            }\r\n          }\r\n        );\r\n        \r\n        // If API doesn't return data yet, generate mock data for development\r\n        if (!attendanceResponse.data || !attendanceResponse.data.data) {\r\n          const mockData = generateMockAttendanceData(filters.startDate, filters.endDate);\r\n          setAttendanceHistory(mockData);\r\n        } else {\r\n          setAttendanceHistory(attendanceResponse.data.data);\r\n        }\r\n        \r\n      } catch (error) {\r\n        console.error('Error fetching student data:', error);\r\n        setError(error.response?.data?.message || 'Failed to load student data');\r\n        \r\n        // Generate mock data for development\r\n        const mockStudent = {\r\n          _id: studentId,\r\n          studentId: 'SATHI-2023-A-001',\r\n          name: {\r\n            en: 'Sample Student',\r\n            si: 'නියැදි සිසුවා'\r\n          },\r\n          dateOfBirth: '2015-05-15',\r\n          ageGroup: '7-10',\r\n          classYear: '2023',\r\n          classCode: 'A',\r\n          parentInfo: {\r\n            name: {\r\n              en: 'Parent Name',\r\n              si: 'දෙමාපිය නම'\r\n            },\r\n            phone: '0771234567',\r\n            email: 'parent@example.com'\r\n          }\r\n        };\r\n        \r\n        setStudent(mockStudent);\r\n        \r\n        const mockData = generateMockAttendanceData(filters.startDate, filters.endDate);\r\n        setAttendanceHistory(mockData);\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n    \r\n    fetchStudentData();\r\n  }, [studentId, filters.startDate, filters.endDate]);\r\n\r\n  // Generate mock attendance data for development\r\n  const generateMockAttendanceData = (startDate, endDate) => {\r\n    const start = new Date(startDate);\r\n    const end = new Date(endDate);\r\n    const attendanceData = [];\r\n    \r\n    const currentDate = new Date(start);\r\n    \r\n    while (currentDate <= end) {\r\n      // Only include Sundays\r\n      if (currentDate.getDay() === 0) {\r\n        // Random attendance status\r\n        const random = Math.random();\r\n        let status;\r\n        let reason = '';\r\n        \r\n        if (random < 0.75) {\r\n          status = 'present';\r\n        } else if (random < 0.9) {\r\n          status = 'absent';\r\n          reason = 'Sick leave';\r\n        } else {\r\n          status = 'late';\r\n          reason = 'Traffic delay';\r\n        }\r\n        \r\n        attendanceData.push({\r\n          date: new Date(currentDate).toISOString().split('T')[0],\r\n          status,\r\n          reason\r\n        });\r\n      }\r\n      \r\n      // Move to next day\r\n      currentDate.setDate(currentDate.getDate() + 1);\r\n    }\r\n    \r\n    return attendanceData;\r\n  };\r\n  \r\n  const handleFilterChange = (e) => {\r\n    const { name, value } = e.target;\r\n    setFilters(prev => ({ ...prev, [name]: value }));\r\n  };\r\n  \r\n  // Calculate statistics\r\n  const calculateStats = () => {\r\n    const total = attendanceHistory.length;\r\n    const present = attendanceHistory.filter(item => item.status === 'present').length;\r\n    const absent = attendanceHistory.filter(item => item.status === 'absent').length;\r\n    const late = attendanceHistory.filter(item => item.status === 'late').length;\r\n    \r\n    const presentRate = total > 0 ? (present / total * 100).toFixed(1) : 0;\r\n    const absentRate = total > 0 ? (absent / total * 100).toFixed(1) : 0;\r\n    const lateRate = total > 0 ? (late / total * 100).toFixed(1) : 0;\r\n    \r\n    return {\r\n      total,\r\n      present,\r\n      absent,\r\n      late,\r\n      presentRate,\r\n      absentRate,\r\n      lateRate\r\n    };\r\n  };\r\n  \r\n  const stats = calculateStats();\r\n  \r\n  const handleExportCSV = () => {\r\n    if (!student) return;\r\n    \r\n    // Create CSV content\r\n    const headers = \"Date,Status,Reason\\n\";\r\n    const rows = attendanceHistory.map(item =>\r\n      `${item.date},${item.status},${item.reason || ''}`\r\n    ).join('\\n');\r\n    \r\n    const csvContent = headers + rows;\r\n    const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });\r\n    const url = URL.createObjectURL(blob);\r\n    \r\n    const link = document.createElement('a');\r\n    link.setAttribute('href', url);\r\n    link.setAttribute('download', `${student.studentId}-attendance.csv`);\r\n    link.style.visibility = 'hidden';\r\n    document.body.appendChild(link);\r\n    link.click();\r\n    document.body.removeChild(link);\r\n  };\r\n  \r\n  if (loading) {\r\n    return <div className=\"flex justify-center items-center h-full\">Loading...</div>;\r\n  }\r\n  \r\n  if (error) {\r\n    return (\r\n      <div className=\"p-6 bg-red-100 text-red-700 dark:bg-red-900 dark:text-red-300 rounded\">\r\n        {error}\r\n      </div>\r\n    );\r\n  }\r\n  \r\n  if (!student) {\r\n    return (\r\n      <div className=\"p-6 bg-yellow-100 text-yellow-700 dark:bg-yellow-900 dark:text-yellow-300 rounded\">\r\n        {t('admin.students.studentNotFound')}\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg shadow p-6\">\r\n        <div className=\"flex flex-col md:flex-row md:items-center md:justify-between mb-6\">\r\n          <div>\r\n            <h2 className=\"text-xl font-semibold text-gray-900 dark:text-white\">\r\n              {t('admin.attendance.studentAttendance')}\r\n            </h2>\r\n            <p className=\"text-gray-600 dark:text-gray-400\">\r\n              {student.name.en} ({student.studentId})\r\n            </p>\r\n          </div>\r\n          \r\n          <div className=\"mt-4 md:mt-0\">\r\n            <button\r\n              onClick={handleExportCSV}\r\n              className=\"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 transition-colors\"\r\n            >\r\n              {t('admin.export.csv')}\r\n            </button>\r\n          </div>\r\n        </div>\r\n        \r\n        {/* Student Info */}\r\n        <div className=\"bg-blue-50 dark:bg-blue-900 p-4 rounded-lg mb-6\">\r\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4\">\r\n            <div>\r\n              <h3 className=\"text-sm font-medium text-gray-700 dark:text-gray-300\">\r\n                {t('admin.students.name')}\r\n              </h3>\r\n              <p className=\"text-base font-medium text-gray-900 dark:text-white\">\r\n                {student.name.en}\r\n              </p>\r\n              <p className=\"text-sm text-gray-500 dark:text-gray-400\">\r\n                {student.name.si}\r\n              </p>\r\n            </div>\r\n            \r\n            <div>\r\n              <h3 className=\"text-sm font-medium text-gray-700 dark:text-gray-300\">\r\n                {t('admin.students.class')}\r\n              </h3>\r\n              <p className=\"text-base font-medium text-gray-900 dark:text-white\">\r\n                {student.classYear}-{student.classCode}\r\n              </p>\r\n              <p className=\"text-sm text-gray-500 dark:text-gray-400\">\r\n                {student.ageGroup} {t('admin.students.years')}\r\n              </p>\r\n            </div>\r\n            \r\n            <div>\r\n              <h3 className=\"text-sm font-medium text-gray-700 dark:text-gray-300\">\r\n                {t('admin.students.dateOfBirth')}\r\n              </h3>\r\n              <p className=\"text-base font-medium text-gray-900 dark:text-white\">\r\n                {new Date(student.dateOfBirth).toLocaleDateString()}\r\n              </p>\r\n            </div>\r\n            \r\n            <div>\r\n              <h3 className=\"text-sm font-medium text-gray-700 dark:text-gray-300\">\r\n                {t('admin.students.contact')}\r\n              </h3>\r\n              <p className=\"text-base font-medium text-gray-900 dark:text-white\">\r\n                {student.parentInfo.phone}\r\n              </p>\r\n              <p className=\"text-sm text-gray-500 dark:text-gray-400\">\r\n                {student.parentInfo.name.en}\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        \r\n        {/* Date Range Filter */}\r\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6\">\r\n          <div>\r\n            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n              {t('admin.attendance.startDate')}\r\n            </label>\r\n            <input\r\n              type=\"date\"\r\n              name=\"startDate\"\r\n              value={filters.startDate}\r\n              onChange={handleFilterChange}\r\n              className=\"w-full px-3 py-2 border rounded focus:outline-none focus:ring focus:border-blue-300 dark:bg-gray-700 dark:text-white dark:border-gray-600\"\r\n            />\r\n          </div>\r\n          \r\n          <div>\r\n            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n              {t('admin.attendance.endDate')}\r\n            </label>\r\n            <input\r\n              type=\"date\"\r\n              name=\"endDate\"\r\n              value={filters.endDate}\r\n              onChange={handleFilterChange}\r\n              className=\"w-full px-3 py-2 border rounded focus:outline-none focus:ring focus:border-blue-300 dark:bg-gray-700 dark:text-white dark:border-gray-600\"\r\n            />\r\n          </div>\r\n        </div>\r\n        \r\n        {/* Attendance Summary */}\r\n        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6\">\r\n          <div className=\"bg-green-50 dark:bg-green-900 p-4 rounded-lg\">\r\n            <h3 className=\"text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n              {t('admin.attendance.present')}\r\n            </h3>\r\n            <p className=\"text-lg font-semibold text-green-800 dark:text-green-200\">\r\n              {stats.present} ({stats.presentRate}%)\r\n            </p>\r\n          </div>\r\n          \r\n          <div className=\"bg-yellow-50 dark:bg-yellow-900 p-4 rounded-lg\">\r\n            <h3 className=\"text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n              {t('admin.attendance.absent')}\r\n            </h3>\r\n            <p className=\"text-lg font-semibold text-yellow-800 dark:text-yellow-200\">\r\n              {stats.absent} ({stats.absentRate}%)\r\n            </p>\r\n          </div>\r\n          \r\n          <div className=\"bg-red-50 dark:bg-red-900 p-4 rounded-lg\">\r\n            <h3 className=\"text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n              {t('admin.attendance.late')}\r\n            </h3>\r\n            <p className=\"text-lg font-semibold text-red-800 dark:text-red-200\">\r\n              {stats.late} ({stats.lateRate}%)\r\n            </p>\r\n          </div>\r\n        </div>\r\n        \r\n        {/* Attendance Table */}\r\n        <div className=\"overflow-x-auto rounded-lg shadow\">\r\n          <table className=\"min-w-full bg-white dark:bg-gray-800\">\r\n            <thead className=\"bg-gray-100 dark:bg-gray-700\">\r\n              <tr>\r\n                <th className=\"px-4 py-2 text-left text-sm font-medium text-gray-700 dark:text-gray-300\">\r\n                  {t('admin.attendance.date')}\r\n                </th>\r\n                <th className=\"px-4 py-2 text-left text-sm font-medium text-gray-700 dark:text-gray-300\">\r\n                  {t('admin.attendance.status')}\r\n                </th>\r\n                <th className=\"px-4 py-2 text-left text-sm font-medium text-gray-700 dark:text-gray-300\">\r\n                  {t('admin.attendance.reason')}\r\n                </th>\r\n              </tr>\r\n            </thead>\r\n            \r\n            <tbody className=\"divide-y divide-gray-200 dark:divide-gray-700\">\r\n              {attendanceHistory.map((item) => (\r\n                <tr key={item.date}>\r\n                  <td className=\"px-4 py-2 text-sm text-gray-900 dark:text-white\">\r\n                    {new Date(item.date).toLocaleDateString()}\r\n                  </td>\r\n                  <td className=\"px-4 py-2 text-sm\">\r\n                    <span\r\n                      className={`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${\r\n                        item.status === 'present'\r\n                          ? 'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300'\r\n                          : item.status === 'absent'\r\n                          ? 'bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300'\r\n                          : 'bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300'\r\n                      }`}\r\n                    >\r\n                      {t(`admin.attendance.${item.status}`)}\r\n                    </span>\r\n                  </td>\r\n                  <td className=\"px-4 py-2 text-sm text-gray-900 dark:text-white\">\r\n                    {item.reason || '-'}\r\n                  </td>\r\n                </tr>\r\n              ))}\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default StudentAttendance;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}