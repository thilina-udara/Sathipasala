{"ast":null,"code":"var _jsxFileName = \"D:\\\\Sathipasala\\\\sathipasala-management-system\\\\frontend\\\\src\\\\pages\\\\admin\\\\AttendanceAnalysis.jsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useCallback } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport axios from 'axios';\nimport { LineChart, Line, XAxis, YAxis, Tooltip, ResponsiveContainer, CartesianGrid, BarChart, Bar, PieChart, Pie, Cell, Legend } from 'recharts';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst COLORS = ['#10b981', '#ef4444', '#f59e42', '#6366f1'];\n\n// Class labels in both languages\nconst CLASS_LABELS = {\n  ADH: {\n    en: \"Adhiṭṭhāna\",\n    si: \"අධිඨාන\"\n  },\n  MET: {\n    en: \"Mettā\",\n    si: \"මෙත්තා\"\n  },\n  KHA: {\n    en: \"Khanti\",\n    si: \"ඛන්ති\"\n  },\n  NEK: {\n    en: \"Nekkhamma\",\n    si: \"නෙක්කම්ම\"\n  }\n};\nconst AttendanceAnalysis = () => {\n  _s();\n  const {\n    i18n\n  } = useTranslation();\n  const currentLang = i18n.language || 'en';\n\n  // Simple direct labels based on language\n  const L = {\n    analysis: currentLang === 'si' ? \"පැමිණීමේ විශ්ලේෂණය\" : \"Attendance Analysis\",\n    exportCSV: currentLang === 'si' ? \"CSV අපනයනය කරන්න\" : \"Export CSV\",\n    month: currentLang === 'si' ? \"මාසය\" : \"Month\",\n    year: currentLang === 'si' ? \"වර්ෂය\" : \"Year\",\n    class: currentLang === 'si' ? \"පන්තිය\" : \"Class\",\n    search: currentLang === 'si' ? \"සොයන්න\" : \"Search\",\n    searchPlaceholder: currentLang === 'si' ? \"නම හෝ අංකය සොයන්න\" : \"Search by name or ID\",\n    all: currentLang === 'si' ? \"සියල්ල\" : \"All\",\n    selectStudent: currentLang === 'si' ? \"ශිෂ්‍යයා තෝරන්න\" : \"Select Student\",\n    students: currentLang === 'si' ? \"සිසුන්\" : \"students\",\n    attendanceRate: currentLang === 'si' ? \"පැමිණීමේ අනුපාතය\" : \"Attendance Rate\",\n    trend: currentLang === 'si' ? \"පැමිණීමේ ප්‍රවණතාව\" : \"Attendance Trend\",\n    dailyBreakdown: currentLang === 'si' ? \"දෛනික වාර්තාව\" : \"Daily Breakdown\",\n    present: currentLang === 'si' ? \"පැමිණ සිටි\" : \"Present\",\n    absent: currentLang === 'si' ? \"පැමිණ නොසිටි\" : \"Absent\",\n    late: currentLang === 'si' ? \"ප්‍රමාද වූ\" : \"Late\",\n    sundays: currentLang === 'si' ? \"ඉරිදා දිනයන්\" : \"Sundays\",\n    poya: currentLang === 'si' ? \"පොහෝය දින\" : \"Poya Days\",\n    flower: currentLang === 'si' ? \"මල් පූජා\" : \"Flower Offerings\",\n    poyaDay: currentLang === 'si' ? \"පොහෝය දිනය\" : \"Poya Day\",\n    sunday: currentLang === 'si' ? \"ඉරිදා\" : \"Sunday\",\n    noSundaysInMonth: currentLang === 'si' ? \"මෙම මාසයේ ඉරිදා දින නොමැත\" : \"No Sundays in this month\",\n    flowerParticipation: currentLang === 'si' ? \"මල් පූජා සහභාගිත්වය\" : \"Flower Offering Participation\",\n    noData: currentLang === 'si' ? \"දත්ත නොමැත\" : \"No data available\",\n    student: currentLang === 'si' ? \"සිසුවා\" : \"Student\",\n    flowerType: currentLang === 'si' ? \"මල් වර්ගය\" : \"Flower Type\",\n    status: currentLang === 'si' ? \"තත්ත්වය\" : \"Status\",\n    brought: currentLang === 'si' ? \"ගෙනා\" : \"Brought\",\n    notBrought: currentLang === 'si' ? \"ගෙන ආවේ නැත\" : \"Not Brought\",\n    individualAnalysis: currentLang === 'si' ? \"තනි සිසු විශ්ලේෂණය\" : \"Individual Student Analysis\",\n    date: currentLang === 'si' ? \"දිනය\" : \"Date\",\n    errorFetch: currentLang === 'si' ? \"දත්ත ලබා ගැනීමේ දෝෂයකි\" : \"Error fetching data\"\n  };\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n  const [attendanceData, setAttendanceData] = useState([]);\n  const [students, setStudents] = useState([]);\n  const [summary, setSummary] = useState({\n    totalStudents: 0,\n    averageAttendance: 0,\n    highestAttendanceDay: '',\n    lowestAttendanceDay: ''\n  });\n  const [flowerData, setFlowerData] = useState([]);\n  const [selectedStudent, setSelectedStudent] = useState('');\n  const [filters, setFilters] = useState({\n    month: new Date().getMonth() + 1,\n    year: new Date().getFullYear(),\n    classCode: '',\n    searchTerm: '',\n    studentId: '',\n    eventType: ''\n  });\n\n  // Get month names based on current language\n  const getMonthNames = () => {\n    const months = [];\n    for (let i = 0; i < 12; i++) {\n      const date = new Date(2022, i, 1);\n      months.push(date.toLocaleString(currentLang, {\n        month: 'long'\n      }));\n    }\n    return months;\n  };\n\n  // Fetch students data\n  const fetchStudents = useCallback(async () => {\n    try {\n      var _response$data;\n      setLoading(true);\n      const response = await axios.get('/api/students', {\n        headers: {\n          Authorization: `Bearer ${localStorage.getItem('token')}`\n        },\n        params: {\n          classYear: filters.year,\n          classCode: filters.classCode || undefined\n        }\n      });\n      if ((_response$data = response.data) !== null && _response$data !== void 0 && _response$data.data) {\n        setStudents(response.data.data);\n        return response.data.data;\n      } else {\n        // Generate mock data for development\n        const mockStudents = generateMockStudents();\n        setStudents(mockStudents);\n        return mockStudents;\n      }\n    } catch (error) {\n      console.error(\"Error fetching students:\", error);\n      // Fall back to mock data\n      const mockStudents = generateMockStudents();\n      setStudents(mockStudents);\n      return mockStudents;\n    }\n  }, [filters.year, filters.classCode]);\n\n  // Generate mock students for development\n  const generateMockStudents = () => {\n    const classMapping = {\n      'ADH': '3-6',\n      'MET': '7-10',\n      'KHA': '11-13',\n      'NEK': '14+'\n    };\n    return Array.from({\n      length: 40\n    }, (_, i) => {\n      const id = i + 1;\n      const classCode = ['ADH', 'MET', 'KHA', 'NEK'][Math.floor(Math.random() * 4)];\n      return {\n        _id: `mock-${id}`,\n        studentId: `SATHI-${filters.year}-${classCode}-${id.toString().padStart(3, '0')}`,\n        name: {\n          en: `Student ${id}`,\n          si: `ශිෂ්‍ය ${id}`\n        },\n        classYear: filters.year,\n        classCode,\n        ageGroup: classMapping[classCode]\n      };\n    });\n  };\n\n  // Generate mock attendance data\n  const generateMockData = useCallback(studentsList => {\n    if (!studentsList || !studentsList.length) return [];\n\n    // Get all Sundays in the specified month\n    const sundays = getSundaysInMonth(filters.month, filters.year);\n    const attendanceRecords = [];\n\n    // Mock data for each Sunday\n    sundays.forEach((sunday, index) => {\n      const date = sunday.toISOString().split('T')[0];\n      const isPoya = index === 1 || index === 3; // 2nd and 4th Sunday as mock Poya days\n      const isFlowerDay = index === 0; // 1st Sunday as mock Flower day\n\n      // Random attendance with better probability for presence (75-90%)\n      const attendanceRate = 80 + Math.floor(Math.random() * 15) - Math.floor(Math.random() * 10);\n      const total = studentsList.length;\n      const present = Math.round(attendanceRate / 100 * total);\n      const late = Math.round(Math.random() * (total - present) * 0.3);\n      const absent = total - present - late;\n      attendanceRecords.push({\n        date,\n        total,\n        present,\n        absent,\n        late,\n        attendanceRate,\n        isPoya,\n        isFlowerDay\n      });\n\n      // Add flower offering data for flower days\n      if (isFlowerDay) {\n        const participants = studentsList.filter(() => Math.random() > 0.3) // 70% participation rate\n        .map(student => ({\n          studentId: student.studentId,\n          name: student.name[currentLang],\n          flowerType: ['Rose', 'Lotus', 'Jasmine', 'Marigold', 'Sunflower'][Math.floor(Math.random() * 5)],\n          brought: Math.random() > 0.2 // 80% actually brought flowers\n        }));\n        setFlowerData(prev => [...prev, {\n          date,\n          participation: participants\n        }]);\n      }\n    });\n    return attendanceRecords;\n  }, [filters.month, filters.year, currentLang]);\n\n  // Fetch or generate attendance data\n  const fetchAttendance = useCallback(async studentsList => {\n    try {\n      var _response$data2;\n      const response = await axios.get('/api/attendance/report', {\n        headers: {\n          Authorization: `Bearer ${localStorage.getItem('token')}`\n        },\n        params: {\n          year: filters.year,\n          month: filters.month,\n          classCode: filters.classCode || undefined\n        }\n      });\n      if ((_response$data2 = response.data) !== null && _response$data2 !== void 0 && _response$data2.data) {\n        setAttendanceData(response.data.data);\n        // Calculate summary stats\n        if (response.data.data.length > 0) {\n          const avgAttendance = response.data.data.reduce((sum, day) => sum + day.attendanceRate, 0) / response.data.data.length;\n          const highest = response.data.data.reduce((max, day) => day.attendanceRate > max.rate ? {\n            rate: day.attendanceRate,\n            date: day.date\n          } : max, {\n            rate: 0,\n            date: ''\n          });\n          const lowest = response.data.data.reduce((min, day) => day.attendanceRate < min.rate ? {\n            rate: day.attendanceRate,\n            date: day.date\n          } : min, {\n            rate: 100,\n            date: ''\n          });\n          setSummary({\n            totalStudents: (studentsList === null || studentsList === void 0 ? void 0 : studentsList.length) || 0,\n            averageAttendance: avgAttendance.toFixed(1),\n            highestAttendanceDay: highest.date,\n            lowestAttendanceDay: lowest.date\n          });\n        }\n\n        // Get flower data\n        const flowerDays = response.data.data.filter(day => day.flowerOfferings > 0);\n        if (flowerDays.length > 0) {\n          setFlowerData(flowerDays.map(day => ({\n            date: day.date,\n            participation: day.students.filter(s => {\n              var _s$flowerOffering;\n              return (_s$flowerOffering = s.flowerOffering) === null || _s$flowerOffering === void 0 ? void 0 : _s$flowerOffering.brought;\n            })\n          })));\n        }\n      } else {\n        // Use mock data\n        const mockData = generateMockData(studentsList);\n        setAttendanceData(mockData);\n        if (mockData.length > 0) {\n          const avgAttendance = mockData.reduce((sum, day) => sum + day.attendanceRate, 0) / mockData.length;\n          const highest = mockData.reduce((max, day) => day.attendanceRate > max.rate ? {\n            rate: day.attendanceRate,\n            date: day.date\n          } : max, {\n            rate: 0,\n            date: ''\n          });\n          const lowest = mockData.reduce((min, day) => day.attendanceRate < min.rate ? {\n            rate: day.attendanceRate,\n            date: day.date\n          } : min, {\n            rate: 100,\n            date: ''\n          });\n          setSummary({\n            totalStudents: (studentsList === null || studentsList === void 0 ? void 0 : studentsList.length) || 0,\n            averageAttendance: avgAttendance.toFixed(1),\n            highestAttendanceDay: highest.date,\n            lowestAttendanceDay: lowest.date\n          });\n        }\n      }\n    } catch (error) {\n      console.error(\"Error fetching attendance data:\", error);\n\n      // Use mock data\n      const mockData = generateMockData(studentsList);\n      setAttendanceData(mockData);\n      if (mockData.length > 0) {\n        var _mockData$, _mockData;\n        const avgAttendance = mockData.reduce((sum, day) => sum + day.attendanceRate, 0) / mockData.length;\n        setSummary({\n          totalStudents: (studentsList === null || studentsList === void 0 ? void 0 : studentsList.length) || 0,\n          averageAttendance: avgAttendance.toFixed(1),\n          highestAttendanceDay: ((_mockData$ = mockData[0]) === null || _mockData$ === void 0 ? void 0 : _mockData$.date) || '',\n          lowestAttendanceDay: ((_mockData = mockData[mockData.length - 1]) === null || _mockData === void 0 ? void 0 : _mockData.date) || ''\n        });\n      }\n    } finally {\n      setLoading(false);\n    }\n  }, [filters.year, filters.month, filters.classCode, generateMockData]);\n\n  // Main data fetch effect\n  useEffect(() => {\n    const fetchData = async () => {\n      // Reset when filters change\n      setFlowerData([]);\n      setError(null);\n      try {\n        // First get students\n        const studentsData = await fetchStudents();\n        // Then get attendance based on students\n        await fetchAttendance(studentsData);\n      } catch (error) {\n        console.error(\"Error in data fetching:\", error);\n        setError(L.errorFetch);\n        setLoading(false);\n      }\n    };\n    fetchData();\n  }, [fetchStudents, fetchAttendance, filters, currentLang]);\n\n  // Filtered students for dropdown\n  const filteredStudents = students.filter(student => !filters.searchTerm || student.name[currentLang] && student.name[currentLang].toLowerCase().includes(filters.searchTerm.toLowerCase()) || student.studentId.toLowerCase().includes(filters.searchTerm.toLowerCase()));\n\n  // Export CSV\n  const handleExportCSV = () => {\n    if (!attendanceData || attendanceData.length === 0) return;\n\n    // Create CSV content\n    const headers = \"Date,Total Students,Present,Absent,Late,Attendance Rate\\n\";\n    const rows = attendanceData.map(day => `${day.date},${day.total},${day.present},${day.absent},${day.late},${day.attendanceRate}%`).join('\\n');\n    const csvContent = headers + rows;\n    const blob = new Blob([csvContent], {\n      type: 'text/csv;charset=utf-8;'\n    });\n    const url = URL.createObjectURL(blob);\n    const link = document.createElement('a');\n    link.setAttribute('href', url);\n    link.setAttribute('download', `attendance-${filters.year}-${filters.month}.csv`);\n    link.style.visibility = 'hidden';\n    document.body.appendChild(link);\n    link.click();\n    document.body.removeChild(link);\n  };\n\n  // Class-wise summary\n  const classSummary = ['ADH', 'MET', 'KHA', 'NEK'].map(code => {\n    const classStudents = students.filter(s => s.classCode === code);\n    const total = classStudents.length;\n\n    // Calculate attendance percentage for this class\n    let percent = 0;\n    if (attendanceData.length > 0) {\n      // Mock calculation (in real app, use actual data)\n      percent = (70 + Math.floor(Math.random() * 25)).toFixed(1);\n    }\n    return {\n      code,\n      label: CLASS_LABELS[code][currentLang],\n      total,\n      percent\n    };\n  });\n\n  // Pie chart data for present/absent/late\n  const pieData = [{\n    name: L.present,\n    value: attendanceData.reduce((sum, d) => sum + d.present, 0)\n  }, {\n    name: L.absent,\n    value: attendanceData.reduce((sum, d) => sum + d.absent, 0)\n  }, {\n    name: L.late,\n    value: attendanceData.reduce((sum, d) => sum + d.late, 0)\n  }];\n\n  // Get Sundays in current month\n  function getSundaysInMonth(month, year) {\n    const sundays = [];\n    const date = new Date(year, month - 1, 1);\n\n    // Move to the first Sunday in the month\n    while (date.getDay() !== 0) {\n      date.setDate(date.getDate() + 1);\n    }\n\n    // Collect all Sundays\n    while (date.getMonth() === month - 1) {\n      sundays.push(new Date(date));\n      date.setDate(date.getDate() + 7);\n    }\n    return sundays;\n  }\n\n  // Individual student attendance data\n  const handleStudentSelect = useCallback(async studentId => {\n    setSelectedStudent(studentId);\n    if (!studentId) return;\n    setLoading(true);\n    try {\n      var _response$data3;\n      // Try to get actual data from API\n      const response = await axios.get(`/api/attendance/student/${studentId}`, {\n        headers: {\n          Authorization: `Bearer ${localStorage.getItem('token')}`\n        },\n        params: {\n          year: filters.year,\n          month: filters.month\n        }\n      });\n      if ((_response$data3 = response.data) !== null && _response$data3 !== void 0 && _response$data3.data) {\n        // Format real data\n      } else {\n        // Generate mock data for development\n      }\n    } catch (error) {\n      console.error(\"Error fetching student attendance:\", error);\n      // Generate mock data for selected student\n    } finally {\n      setLoading(false);\n    }\n  }, [filters.year, filters.month]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"space-y-6\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"bg-white dark:bg-gray-800 rounded-lg shadow p-6\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex flex-col md:flex-row md:items-center md:justify-between mb-6\",\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          className: \"text-2xl font-bold text-gray-900 dark:text-white mb-4 md:mb-0\",\n          children: L.analysis\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 419,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex gap-2\",\n          children: /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: handleExportCSV,\n            className: \"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 transition-colors\",\n            disabled: !attendanceData.length,\n            children: L.exportCSV\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 423,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 422,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 418,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"grid grid-cols-1 md:grid-cols-5 gap-4 mb-6\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            className: \"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\",\n            children: L.month\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 436,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n            name: \"month\",\n            value: filters.month,\n            onChange: e => setFilters(f => ({\n              ...f,\n              month: Number(e.target.value)\n            })),\n            className: \"w-full px-3 py-2 border rounded focus:outline-none focus:ring focus:border-blue-300 dark:bg-gray-700 dark:text-white dark:border-gray-600\",\n            children: getMonthNames().map((month, idx) => /*#__PURE__*/_jsxDEV(\"option\", {\n              value: idx + 1,\n              children: month\n            }, idx, false, {\n              fileName: _jsxFileName,\n              lineNumber: 446,\n              columnNumber: 17\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 439,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 435,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            className: \"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\",\n            children: L.year\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 453,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n            name: \"year\",\n            value: filters.year,\n            onChange: e => setFilters(f => ({\n              ...f,\n              year: Number(e.target.value)\n            })),\n            className: \"w-full px-3 py-2 border rounded focus:outline-none focus:ring focus:border-blue-300 dark:bg-gray-700 dark:text-white dark:border-gray-600\",\n            children: [...Array(5)].map((_, i) => /*#__PURE__*/_jsxDEV(\"option\", {\n              value: new Date().getFullYear() - i,\n              children: new Date().getFullYear() - i\n            }, i, false, {\n              fileName: _jsxFileName,\n              lineNumber: 463,\n              columnNumber: 17\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 456,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 452,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            className: \"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\",\n            children: L.class\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 470,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n            name: \"classCode\",\n            value: filters.classCode,\n            onChange: e => setFilters(f => ({\n              ...f,\n              classCode: e.target.value\n            })),\n            className: \"w-full px-3 py-2 border rounded focus:outline-none focus:ring focus:border-blue-300 dark:bg-gray-700 dark:text-white dark:border-gray-600\",\n            children: [/*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"\",\n              children: L.all\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 479,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"ADH\",\n              children: CLASS_LABELS.ADH[currentLang]\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 480,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"MET\",\n              children: CLASS_LABELS.MET[currentLang]\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 481,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"KHA\",\n              children: CLASS_LABELS.KHA[currentLang]\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 482,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"NEK\",\n              children: CLASS_LABELS.NEK[currentLang]\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 483,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 473,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 469,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"md:col-span-2\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            className: \"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\",\n            children: L.search\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 487,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"text\",\n            value: filters.searchTerm,\n            onChange: e => setFilters(f => ({\n              ...f,\n              searchTerm: e.target.value\n            })),\n            placeholder: L.searchPlaceholder,\n            className: \"w-full px-3 py-2 border rounded focus:outline-none focus:ring focus:border-blue-300 dark:bg-gray-700 dark:text-white dark:border-gray-600\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 490,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 486,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 434,\n        columnNumber: 9\n      }, this), filteredStudents.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mb-6\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          className: \"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\",\n          children: L.selectStudent\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 503,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n          value: selectedStudent,\n          onChange: e => handleStudentSelect(e.target.value),\n          className: \"w-full px-3 py-2 border rounded focus:outline-none focus:ring focus:border-blue-300 dark:bg-gray-700 dark:text-white dark:border-gray-600\",\n          children: [/*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"\",\n            children: L.all\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 511,\n            columnNumber: 15\n          }, this), filteredStudents.map(student => /*#__PURE__*/_jsxDEV(\"option\", {\n            value: student._id,\n            children: [student.studentId, \" - \", student.name[currentLang]]\n          }, student._id, true, {\n            fileName: _jsxFileName,\n            lineNumber: 513,\n            columnNumber: 17\n          }, this))]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 506,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 502,\n        columnNumber: 11\n      }, this), error && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"p-3 mb-4 bg-red-100 text-red-700 dark:bg-red-900 dark:text-red-300 rounded\",\n        children: error\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 523,\n        columnNumber: 11\n      }, this), loading && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex justify-center items-center p-8\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 529,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 528,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6\",\n        children: classSummary.map(cls => /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"bg-blue-50 dark:bg-blue-900 p-4 rounded-lg\",\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            className: \"text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\",\n            children: cls.label\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 537,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-lg font-semibold text-blue-800 dark:text-blue-200\",\n            children: [cls.total, \" \", L.students]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 540,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-sm text-green-700 dark:text-green-300\",\n            children: [L.attendanceRate, \": \", cls.percent, \"%\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 543,\n            columnNumber: 15\n          }, this)]\n        }, cls.code, true, {\n          fileName: _jsxFileName,\n          lineNumber: 536,\n          columnNumber: 13\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 534,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mb-8\",\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          className: \"text-lg font-medium text-gray-900 dark:text-white mb-4\",\n          children: L.trend\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 552,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            width: '100%',\n            height: 250\n          },\n          children: /*#__PURE__*/_jsxDEV(ResponsiveContainer, {\n            children: /*#__PURE__*/_jsxDEV(LineChart, {\n              data: attendanceData,\n              children: [/*#__PURE__*/_jsxDEV(CartesianGrid, {\n                strokeDasharray: \"3 3\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 558,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(XAxis, {\n                dataKey: \"date\",\n                tickFormatter: d => new Date(d).getDate()\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 559,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(YAxis, {\n                domain: [0, 100],\n                tickFormatter: v => `${v}%`\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 560,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(Tooltip, {\n                formatter: v => `${v}%`,\n                labelFormatter: d => new Date(d).toLocaleDateString(currentLang)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 561,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(Line, {\n                type: \"monotone\",\n                dataKey: \"attendanceRate\",\n                stroke: \"#10b981\",\n                strokeWidth: 2,\n                dot: true\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 562,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 557,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 556,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 555,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 551,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mb-8 grid grid-cols-1 md:grid-cols-2 gap-6\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            className: \"text-lg font-medium text-gray-900 dark:text-white mb-4\",\n            children: L.dailyBreakdown\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 571,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              width: '100%',\n              height: 250\n            },\n            children: /*#__PURE__*/_jsxDEV(ResponsiveContainer, {\n              children: /*#__PURE__*/_jsxDEV(BarChart, {\n                data: attendanceData,\n                children: [/*#__PURE__*/_jsxDEV(CartesianGrid, {\n                  strokeDasharray: \"3 3\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 577,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(XAxis, {\n                  dataKey: \"date\",\n                  tickFormatter: d => new Date(d).getDate()\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 578,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(YAxis, {}, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 579,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(Tooltip, {}, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 580,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(Legend, {}, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 581,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(Bar, {\n                  dataKey: \"present\",\n                  fill: \"#10b981\",\n                  name: L.present\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 582,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(Bar, {\n                  dataKey: \"absent\",\n                  fill: \"#ef4444\",\n                  name: L.absent\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 583,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(Bar, {\n                  dataKey: \"late\",\n                  fill: \"#f59e42\",\n                  name: L.late\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 584,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 576,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 575,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 574,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 570,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            className: \"text-lg font-medium text-gray-900 dark:text-white mb-4\",\n            children: L.attendanceRate\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 590,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              width: '100%',\n              height: 250\n            },\n            children: /*#__PURE__*/_jsxDEV(ResponsiveContainer, {\n              children: /*#__PURE__*/_jsxDEV(PieChart, {\n                children: [/*#__PURE__*/_jsxDEV(Pie, {\n                  data: pieData,\n                  dataKey: \"value\",\n                  nameKey: \"name\",\n                  cx: \"50%\",\n                  cy: \"50%\",\n                  outerRadius: 80,\n                  label: true,\n                  children: pieData.map((entry, idx) => /*#__PURE__*/_jsxDEV(Cell, {\n                    fill: COLORS[idx % COLORS.length]\n                  }, `cell-${idx}`, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 606,\n                    columnNumber: 23\n                  }, this))\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 596,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(Legend, {}, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 609,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 595,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 594,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 593,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 589,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 569,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mb-8\",\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          className: \"text-lg font-medium text-gray-900 dark:text-white mb-4\",\n          children: [L.sundays, \" / \", L.poya, \" / \", L.flower, \" - \", getMonthNames()[filters.month - 1], \" \", filters.year]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 618,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex flex-wrap gap-2\",\n          children: [getSundaysInMonth(filters.month, filters.year).map((sunday, index) => {\n            const date = sunday.toISOString().split('T')[0];\n            const dayData = attendanceData.find(d => d.date === date) || {\n              attendanceRate: 0\n            };\n            const isPoya = dayData.isPoya;\n            const isFlower = dayData.isFlowerDay;\n            return /*#__PURE__*/_jsxDEV(\"div\", {\n              // Added index to ensure unique keys\n              className: `rounded-lg shadow p-4 w-36 ${isPoya ? 'bg-yellow-100 dark:bg-yellow-900' : isFlower ? 'bg-pink-100 dark:bg-pink-900' : 'bg-white dark:bg-gray-700'}`,\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"text-center\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"text-sm font-medium\",\n                  children: sunday.getDate()\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 638,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"text-xs text-gray-500\",\n                  children: isPoya ? L.poyaDay : isFlower ? L.flower : L.sunday\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 639,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"mt-2\",\n                  children: /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"w-full bg-gray-200 rounded-full h-2\",\n                    children: /*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"bg-green-600 h-2 rounded-full\",\n                      style: {\n                        width: `${dayData.attendanceRate}%`\n                      }\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 646,\n                      columnNumber: 25\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 645,\n                    columnNumber: 23\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 644,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"mt-1 text-sm font-medium\",\n                  children: [dayData.attendanceRate, \"%\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 652,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 637,\n                columnNumber: 19\n              }, this)\n            }, `${date}-${index}`, false, {\n              fileName: _jsxFileName,\n              lineNumber: 629,\n              columnNumber: 17\n            }, this);\n          }), getSundaysInMonth(filters.month, filters.year).length === 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-center p-6 text-gray-500 dark:text-gray-400 bg-gray-50 dark:bg-gray-900 rounded w-full\",\n            children: L.noSundaysInMonth\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 661,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 621,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 617,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mb-8\",\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          className: \"text-lg font-medium text-gray-900 dark:text-white mb-4\",\n          children: L.flowerParticipation\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 670,\n          columnNumber: 11\n        }, this), flowerData.length === 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-center p-6 text-gray-500 dark:text-gray-400 bg-gray-50 dark:bg-gray-900 rounded\",\n          children: L.noData\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 674,\n          columnNumber: 13\n        }, this) : flowerData.map((day, idx) => /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"mb-4\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"font-semibold mb-2\",\n            children: [new Date(day.date).toLocaleDateString(currentLang), \" (\", L.flower, \")\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 680,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"overflow-x-auto\",\n            children: /*#__PURE__*/_jsxDEV(\"table\", {\n              className: \"min-w-full bg-white dark:bg-gray-800 rounded\",\n              children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n                children: /*#__PURE__*/_jsxDEV(\"tr\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"th\", {\n                    className: \"px-2 py-1 text-left text-xs font-medium\",\n                    children: L.student\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 687,\n                    columnNumber: 25\n                  }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                    className: \"px-2 py-1 text-left text-xs font-medium\",\n                    children: L.flowerType\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 688,\n                    columnNumber: 25\n                  }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                    className: \"px-2 py-1 text-left text-xs font-medium\",\n                    children: L.status\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 689,\n                    columnNumber: 25\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 686,\n                  columnNumber: 23\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 685,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n                children: day.participation.map((stu, index) => /*#__PURE__*/_jsxDEV(\"tr\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                    className: \"px-2 py-1 text-xs\",\n                    children: [stu.name, \" (\", stu.studentId, \")\"]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 695,\n                    columnNumber: 27\n                  }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                    className: \"px-2 py-1 text-xs\",\n                    children: stu.flowerType || '-'\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 696,\n                    columnNumber: 27\n                  }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                    className: \"px-2 py-1 text-xs\",\n                    children: stu.brought ? L.brought : L.notBrought\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 697,\n                    columnNumber: 27\n                  }, this)]\n                }, `${stu.studentId || ''}-${index}`, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 694,\n                  columnNumber: 25\n                }, this))\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 692,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 684,\n              columnNumber: 19\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 683,\n            columnNumber: 17\n          }, this)]\n        }, `flower-${day.date}-${idx}`, true, {\n          fileName: _jsxFileName,\n          lineNumber: 679,\n          columnNumber: 15\n        }, this))]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 669,\n        columnNumber: 9\n      }, this), selectedStudent && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mb-8\",\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          className: \"text-lg font-medium text-gray-900 dark:text-white mb-4\",\n          children: L.individualAnalysis\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 713,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"overflow-x-auto rounded-lg shadow\",\n          children: /*#__PURE__*/_jsxDEV(\"table\", {\n            className: \"min-w-full bg-white dark:bg-gray-800\",\n            children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n              children: /*#__PURE__*/_jsxDEV(\"tr\", {\n                children: [/*#__PURE__*/_jsxDEV(\"th\", {\n                  className: \"px-4 py-2 text-left text-sm font-medium\",\n                  children: L.date\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 720,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                  className: \"px-4 py-2 text-left text-sm font-medium\",\n                  children: L.present\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 721,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                  className: \"px-4 py-2 text-left text-sm font-medium\",\n                  children: L.absent\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 722,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                  className: \"px-4 py-2 text-left text-sm font-medium\",\n                  children: L.late\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 723,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 719,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 718,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n              children: attendanceData.map((day, idx) => /*#__PURE__*/_jsxDEV(\"tr\", {\n                children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                  className: \"px-4 py-2 text-sm\",\n                  children: new Date(day.date).toLocaleDateString(currentLang)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 729,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                  className: \"px-4 py-2 text-sm\",\n                  children: Math.random() > 0.2 ? '1' : '0'\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 732,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                  className: \"px-4 py-2 text-sm\",\n                  children: Math.random() > 0.8 ? '1' : '0'\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 733,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                  className: \"px-4 py-2 text-sm\",\n                  children: Math.random() > 0.9 ? '1' : '0'\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 734,\n                  columnNumber: 23\n                }, this)]\n              }, `${day.date}-${idx}`, true, {\n                fileName: _jsxFileName,\n                lineNumber: 728,\n                columnNumber: 21\n              }, this))\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 726,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 717,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 716,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 712,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 416,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 415,\n    columnNumber: 5\n  }, this);\n};\n_s(AttendanceAnalysis, \"iv3AWMGx1n07Wk0jtCBTx/7TCnM=\", false, function () {\n  return [useTranslation];\n});\n_c = AttendanceAnalysis;\nexport default AttendanceAnalysis;\nvar _c;\n$RefreshReg$(_c, \"AttendanceAnalysis\");","map":{"version":3,"names":["React","useState","useEffect","useCallback","useTranslation","axios","LineChart","Line","XAxis","YAxis","Tooltip","ResponsiveContainer","CartesianGrid","BarChart","Bar","PieChart","Pie","Cell","Legend","jsxDEV","_jsxDEV","COLORS","CLASS_LABELS","ADH","en","si","MET","KHA","NEK","AttendanceAnalysis","_s","i18n","currentLang","language","L","analysis","exportCSV","month","year","class","search","searchPlaceholder","all","selectStudent","students","attendanceRate","trend","dailyBreakdown","present","absent","late","sundays","poya","flower","poyaDay","sunday","noSundaysInMonth","flowerParticipation","noData","student","flowerType","status","brought","notBrought","individualAnalysis","date","errorFetch","loading","setLoading","error","setError","attendanceData","setAttendanceData","setStudents","summary","setSummary","totalStudents","averageAttendance","highestAttendanceDay","lowestAttendanceDay","flowerData","setFlowerData","selectedStudent","setSelectedStudent","filters","setFilters","Date","getMonth","getFullYear","classCode","searchTerm","studentId","eventType","getMonthNames","months","i","push","toLocaleString","fetchStudents","_response$data","response","get","headers","Authorization","localStorage","getItem","params","classYear","undefined","data","mockStudents","generateMockStudents","console","classMapping","Array","from","length","_","id","Math","floor","random","_id","toString","padStart","name","ageGroup","generateMockData","studentsList","getSundaysInMonth","attendanceRecords","forEach","index","toISOString","split","isPoya","isFlowerDay","total","round","participants","filter","map","prev","participation","fetchAttendance","_response$data2","avgAttendance","reduce","sum","day","highest","max","rate","lowest","min","toFixed","flowerDays","flowerOfferings","s","_s$flowerOffering","flowerOffering","mockData","_mockData$","_mockData","fetchData","studentsData","filteredStudents","toLowerCase","includes","handleExportCSV","rows","join","csvContent","blob","Blob","type","url","URL","createObjectURL","link","document","createElement","setAttribute","style","visibility","body","appendChild","click","removeChild","classSummary","code","classStudents","percent","label","pieData","value","d","getDay","setDate","getDate","handleStudentSelect","_response$data3","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onClick","disabled","onChange","e","f","Number","target","idx","placeholder","cls","width","height","strokeDasharray","dataKey","tickFormatter","domain","v","formatter","labelFormatter","toLocaleDateString","stroke","strokeWidth","dot","fill","nameKey","cx","cy","outerRadius","entry","dayData","find","isFlower","stu","_c","$RefreshReg$"],"sources":["D:/Sathipasala/sathipasala-management-system/frontend/src/pages/admin/AttendanceAnalysis.jsx"],"sourcesContent":["import React, { useState, useEffect, useCallback } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport axios from 'axios';\r\nimport { \r\n  LineChart, Line, XAxis, YAxis, Tooltip, ResponsiveContainer, \r\n  CartesianGrid, BarChart, Bar, PieChart, Pie, Cell, Legend \r\n} from 'recharts';\r\n\r\nconst COLORS = ['#10b981', '#ef4444', '#f59e42', '#6366f1'];\r\n\r\n// Class labels in both languages\r\nconst CLASS_LABELS = {\r\n  ADH: { en: \"Adhiṭṭhāna\", si: \"අධිඨාන\" },\r\n  MET: { en: \"Mettā\", si: \"මෙත්තා\" },\r\n  KHA: { en: \"Khanti\", si: \"ඛන්ති\" },\r\n  NEK: { en: \"Nekkhamma\", si: \"නෙක්කම්ම\" }\r\n};\r\n\r\nconst AttendanceAnalysis = () => {\r\n  const { i18n } = useTranslation();\r\n  const currentLang = i18n.language || 'en';\r\n  \r\n  // Simple direct labels based on language\r\n  const L = {\r\n    analysis: currentLang === 'si' ? \"පැමිණීමේ විශ්ලේෂණය\" : \"Attendance Analysis\",\r\n    exportCSV: currentLang === 'si' ? \"CSV අපනයනය කරන්න\" : \"Export CSV\",\r\n    month: currentLang === 'si' ? \"මාසය\" : \"Month\",\r\n    year: currentLang === 'si' ? \"වර්ෂය\" : \"Year\",\r\n    class: currentLang === 'si' ? \"පන්තිය\" : \"Class\",\r\n    search: currentLang === 'si' ? \"සොයන්න\" : \"Search\",\r\n    searchPlaceholder: currentLang === 'si' ? \"නම හෝ අංකය සොයන්න\" : \"Search by name or ID\",\r\n    all: currentLang === 'si' ? \"සියල්ල\" : \"All\",\r\n    selectStudent: currentLang === 'si' ? \"ශිෂ්‍යයා තෝරන්න\" : \"Select Student\",\r\n    students: currentLang === 'si' ? \"සිසුන්\" : \"students\",\r\n    attendanceRate: currentLang === 'si' ? \"පැමිණීමේ අනුපාතය\" : \"Attendance Rate\",\r\n    trend: currentLang === 'si' ? \"පැමිණීමේ ප්‍රවණතාව\" : \"Attendance Trend\",\r\n    dailyBreakdown: currentLang === 'si' ? \"දෛනික වාර්තාව\" : \"Daily Breakdown\",\r\n    present: currentLang === 'si' ? \"පැමිණ සිටි\" : \"Present\",\r\n    absent: currentLang === 'si' ? \"පැමිණ නොසිටි\" : \"Absent\",\r\n    late: currentLang === 'si' ? \"ප්‍රමාද වූ\" : \"Late\",\r\n    sundays: currentLang === 'si' ? \"ඉරිදා දිනයන්\" : \"Sundays\",\r\n    poya: currentLang === 'si' ? \"පොහෝය දින\" : \"Poya Days\",\r\n    flower: currentLang === 'si' ? \"මල් පූජා\" : \"Flower Offerings\",\r\n    poyaDay: currentLang === 'si' ? \"පොහෝය දිනය\" : \"Poya Day\",\r\n    sunday: currentLang === 'si' ? \"ඉරිදා\" : \"Sunday\",\r\n    noSundaysInMonth: currentLang === 'si' ? \"මෙම මාසයේ ඉරිදා දින නොමැත\" : \"No Sundays in this month\",\r\n    flowerParticipation: currentLang === 'si' ? \"මල් පූජා සහභාගිත්වය\" : \"Flower Offering Participation\",\r\n    noData: currentLang === 'si' ? \"දත්ත නොමැත\" : \"No data available\",\r\n    student: currentLang === 'si' ? \"සිසුවා\" : \"Student\",\r\n    flowerType: currentLang === 'si' ? \"මල් වර්ගය\" : \"Flower Type\",\r\n    status: currentLang === 'si' ? \"තත්ත්වය\" : \"Status\",\r\n    brought: currentLang === 'si' ? \"ගෙනා\" : \"Brought\",\r\n    notBrought: currentLang === 'si' ? \"ගෙන ආවේ නැත\" : \"Not Brought\",\r\n    individualAnalysis: currentLang === 'si' ? \"තනි සිසු විශ්ලේෂණය\" : \"Individual Student Analysis\",\r\n    date: currentLang === 'si' ? \"දිනය\" : \"Date\",\r\n    errorFetch: currentLang === 'si' ? \"දත්ත ලබා ගැනීමේ දෝෂයකි\" : \"Error fetching data\"\r\n  };\r\n\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState(null);\r\n  const [attendanceData, setAttendanceData] = useState([]);\r\n  const [students, setStudents] = useState([]);\r\n  const [summary, setSummary] = useState({\r\n    totalStudents: 0,\r\n    averageAttendance: 0,\r\n    highestAttendanceDay: '',\r\n    lowestAttendanceDay: '',\r\n  });\r\n  const [flowerData, setFlowerData] = useState([]);\r\n  const [selectedStudent, setSelectedStudent] = useState('');\r\n  const [filters, setFilters] = useState({\r\n    month: new Date().getMonth() + 1,\r\n    year: new Date().getFullYear(),\r\n    classCode: '',\r\n    searchTerm: '',\r\n    studentId: '',\r\n    eventType: ''\r\n  });\r\n\r\n  // Get month names based on current language\r\n  const getMonthNames = () => {\r\n    const months = [];\r\n    for (let i = 0; i < 12; i++) {\r\n      const date = new Date(2022, i, 1);\r\n      months.push(date.toLocaleString(currentLang, { month: 'long' }));\r\n    }\r\n    return months;\r\n  };\r\n\r\n  // Fetch students data\r\n  const fetchStudents = useCallback(async () => {\r\n    try {\r\n      setLoading(true);\r\n      const response = await axios.get('/api/students', {\r\n        headers: {\r\n          Authorization: `Bearer ${localStorage.getItem('token')}`\r\n        },\r\n        params: {\r\n          classYear: filters.year,\r\n          classCode: filters.classCode || undefined\r\n        }\r\n      });\r\n\r\n      if (response.data?.data) {\r\n        setStudents(response.data.data);\r\n        return response.data.data;\r\n      } else {\r\n        // Generate mock data for development\r\n        const mockStudents = generateMockStudents();\r\n        setStudents(mockStudents);\r\n        return mockStudents;\r\n      }\r\n    } catch (error) {\r\n      console.error(\"Error fetching students:\", error);\r\n      // Fall back to mock data\r\n      const mockStudents = generateMockStudents();\r\n      setStudents(mockStudents);\r\n      return mockStudents;\r\n    }\r\n  }, [filters.year, filters.classCode]);\r\n\r\n  // Generate mock students for development\r\n  const generateMockStudents = () => {\r\n    const classMapping = {\r\n      'ADH': '3-6',\r\n      'MET': '7-10',\r\n      'KHA': '11-13',\r\n      'NEK': '14+'\r\n    };\r\n    \r\n    return Array.from({ length: 40 }, (_, i) => {\r\n      const id = i + 1;\r\n      const classCode = ['ADH', 'MET', 'KHA', 'NEK'][Math.floor(Math.random() * 4)];\r\n      \r\n      return {\r\n        _id: `mock-${id}`,\r\n        studentId: `SATHI-${filters.year}-${classCode}-${id.toString().padStart(3, '0')}`,\r\n        name: {\r\n          en: `Student ${id}`,\r\n          si: `ශිෂ්‍ය ${id}`\r\n        },\r\n        classYear: filters.year,\r\n        classCode,\r\n        ageGroup: classMapping[classCode]\r\n      };\r\n    });\r\n  };\r\n\r\n  // Generate mock attendance data\r\n  const generateMockData = useCallback((studentsList) => {\r\n    if (!studentsList || !studentsList.length) return [];\r\n\r\n    // Get all Sundays in the specified month\r\n    const sundays = getSundaysInMonth(filters.month, filters.year);\r\n    const attendanceRecords = [];\r\n    \r\n    // Mock data for each Sunday\r\n    sundays.forEach((sunday, index) => {\r\n      const date = sunday.toISOString().split('T')[0];\r\n      const isPoya = index === 1 || index === 3; // 2nd and 4th Sunday as mock Poya days\r\n      const isFlowerDay = index === 0; // 1st Sunday as mock Flower day\r\n      \r\n      // Random attendance with better probability for presence (75-90%)\r\n      const attendanceRate = 80 + Math.floor(Math.random() * 15) - Math.floor(Math.random() * 10);\r\n      const total = studentsList.length;\r\n      const present = Math.round((attendanceRate / 100) * total);\r\n      const late = Math.round(Math.random() * (total - present) * 0.3);\r\n      const absent = total - present - late;\r\n      \r\n      attendanceRecords.push({\r\n        date,\r\n        total,\r\n        present,\r\n        absent,\r\n        late,\r\n        attendanceRate,\r\n        isPoya,\r\n        isFlowerDay\r\n      });\r\n      \r\n      // Add flower offering data for flower days\r\n      if (isFlowerDay) {\r\n        const participants = studentsList\r\n          .filter(() => Math.random() > 0.3) // 70% participation rate\r\n          .map(student => ({\r\n            studentId: student.studentId,\r\n            name: student.name[currentLang],\r\n            flowerType: ['Rose', 'Lotus', 'Jasmine', 'Marigold', 'Sunflower'][Math.floor(Math.random() * 5)],\r\n            brought: Math.random() > 0.2 // 80% actually brought flowers\r\n          }));\r\n        \r\n        setFlowerData(prev => [\r\n          ...prev,\r\n          {\r\n            date,\r\n            participation: participants\r\n          }\r\n        ]);\r\n      }\r\n    });\r\n    \r\n    return attendanceRecords;\r\n  }, [filters.month, filters.year, currentLang]);\r\n\r\n  // Fetch or generate attendance data\r\n  const fetchAttendance = useCallback(async (studentsList) => {\r\n    try {\r\n      const response = await axios.get('/api/attendance/report', {\r\n        headers: {\r\n          Authorization: `Bearer ${localStorage.getItem('token')}`\r\n        },\r\n        params: {\r\n          year: filters.year,\r\n          month: filters.month,\r\n          classCode: filters.classCode || undefined\r\n        }\r\n      });\r\n      \r\n      if (response.data?.data) {\r\n        setAttendanceData(response.data.data);\r\n        // Calculate summary stats\r\n        if (response.data.data.length > 0) {\r\n          const avgAttendance = response.data.data.reduce((sum, day) => sum + day.attendanceRate, 0) / response.data.data.length;\r\n          const highest = response.data.data.reduce((max, day) => day.attendanceRate > max.rate ? { rate: day.attendanceRate, date: day.date } : max, { rate: 0, date: '' });\r\n          const lowest = response.data.data.reduce((min, day) => day.attendanceRate < min.rate ? { rate: day.attendanceRate, date: day.date } : min, { rate: 100, date: '' });\r\n          \r\n          setSummary({\r\n            totalStudents: studentsList?.length || 0,\r\n            averageAttendance: avgAttendance.toFixed(1),\r\n            highestAttendanceDay: highest.date,\r\n            lowestAttendanceDay: lowest.date\r\n          });\r\n        }\r\n        \r\n        // Get flower data\r\n        const flowerDays = response.data.data.filter(day => day.flowerOfferings > 0);\r\n        if (flowerDays.length > 0) {\r\n          setFlowerData(flowerDays.map(day => ({\r\n            date: day.date,\r\n            participation: day.students.filter(s => s.flowerOffering?.brought)\r\n          })));\r\n        }\r\n        \r\n      } else {\r\n        // Use mock data\r\n        const mockData = generateMockData(studentsList);\r\n        setAttendanceData(mockData);\r\n        \r\n        if (mockData.length > 0) {\r\n          const avgAttendance = mockData.reduce((sum, day) => sum + day.attendanceRate, 0) / mockData.length;\r\n          const highest = mockData.reduce((max, day) => day.attendanceRate > max.rate ? { rate: day.attendanceRate, date: day.date } : max, { rate: 0, date: '' });\r\n          const lowest = mockData.reduce((min, day) => day.attendanceRate < min.rate ? { rate: day.attendanceRate, date: day.date } : min, { rate: 100, date: '' });\r\n          \r\n          setSummary({\r\n            totalStudents: studentsList?.length || 0,\r\n            averageAttendance: avgAttendance.toFixed(1),\r\n            highestAttendanceDay: highest.date,\r\n            lowestAttendanceDay: lowest.date\r\n          });\r\n        }\r\n      }\r\n    } catch (error) {\r\n      console.error(\"Error fetching attendance data:\", error);\r\n      \r\n      // Use mock data\r\n      const mockData = generateMockData(studentsList);\r\n      setAttendanceData(mockData);\r\n      \r\n      if (mockData.length > 0) {\r\n        const avgAttendance = mockData.reduce((sum, day) => sum + day.attendanceRate, 0) / mockData.length;\r\n        setSummary({\r\n          totalStudents: studentsList?.length || 0,\r\n          averageAttendance: avgAttendance.toFixed(1),\r\n          highestAttendanceDay: mockData[0]?.date || '',\r\n          lowestAttendanceDay: mockData[mockData.length - 1]?.date || ''\r\n        });\r\n      }\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, [filters.year, filters.month, filters.classCode, generateMockData]);\r\n\r\n  // Main data fetch effect\r\n  useEffect(() => {\r\n    const fetchData = async () => {\r\n      // Reset when filters change\r\n      setFlowerData([]);\r\n      setError(null);\r\n      \r\n      try {\r\n        // First get students\r\n        const studentsData = await fetchStudents();\r\n        // Then get attendance based on students\r\n        await fetchAttendance(studentsData);\r\n      } catch (error) {\r\n        console.error(\"Error in data fetching:\", error);\r\n        setError(L.errorFetch);\r\n        setLoading(false);\r\n      }\r\n    };\r\n    \r\n    fetchData();\r\n  }, [fetchStudents, fetchAttendance, filters, currentLang]);\r\n\r\n  // Filtered students for dropdown\r\n  const filteredStudents = students.filter(student =>\r\n    !filters.searchTerm ||\r\n    (student.name[currentLang] && student.name[currentLang].toLowerCase().includes(filters.searchTerm.toLowerCase())) ||\r\n    student.studentId.toLowerCase().includes(filters.searchTerm.toLowerCase())\r\n  );\r\n\r\n  // Export CSV\r\n  const handleExportCSV = () => {\r\n    if (!attendanceData || attendanceData.length === 0) return;\r\n    \r\n    // Create CSV content\r\n    const headers = \"Date,Total Students,Present,Absent,Late,Attendance Rate\\n\";\r\n    const rows = attendanceData.map(day => \r\n      `${day.date},${day.total},${day.present},${day.absent},${day.late},${day.attendanceRate}%`\r\n    ).join('\\n');\r\n    \r\n    const csvContent = headers + rows;\r\n    const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });\r\n    const url = URL.createObjectURL(blob);\r\n    \r\n    const link = document.createElement('a');\r\n    link.setAttribute('href', url);\r\n    link.setAttribute('download', `attendance-${filters.year}-${filters.month}.csv`);\r\n    link.style.visibility = 'hidden';\r\n    document.body.appendChild(link);\r\n    link.click();\r\n    document.body.removeChild(link);\r\n  };\r\n\r\n  // Class-wise summary\r\n  const classSummary = ['ADH', 'MET', 'KHA', 'NEK'].map(code => {\r\n    const classStudents = students.filter(s => s.classCode === code);\r\n    const total = classStudents.length;\r\n    \r\n    // Calculate attendance percentage for this class\r\n    let percent = 0;\r\n    if (attendanceData.length > 0) {\r\n      // Mock calculation (in real app, use actual data)\r\n      percent = (70 + Math.floor(Math.random() * 25)).toFixed(1);\r\n    }\r\n    \r\n    return {\r\n      code,\r\n      label: CLASS_LABELS[code][currentLang],\r\n      total,\r\n      percent\r\n    };\r\n  });\r\n\r\n  // Pie chart data for present/absent/late\r\n  const pieData = [\r\n    { name: L.present, value: attendanceData.reduce((sum, d) => sum + d.present, 0) },\r\n    { name: L.absent, value: attendanceData.reduce((sum, d) => sum + d.absent, 0) },\r\n    { name: L.late, value: attendanceData.reduce((sum, d) => sum + d.late, 0) }\r\n  ];\r\n\r\n  // Get Sundays in current month\r\n  function getSundaysInMonth(month, year) {\r\n    const sundays = [];\r\n    const date = new Date(year, month - 1, 1);\r\n    \r\n    // Move to the first Sunday in the month\r\n    while (date.getDay() !== 0) {\r\n      date.setDate(date.getDate() + 1);\r\n    }\r\n    \r\n    // Collect all Sundays\r\n    while (date.getMonth() === month - 1) {\r\n      sundays.push(new Date(date));\r\n      date.setDate(date.getDate() + 7);\r\n    }\r\n    \r\n    return sundays;\r\n  }\r\n\r\n  // Individual student attendance data\r\n  const handleStudentSelect = useCallback(async (studentId) => {\r\n    setSelectedStudent(studentId);\r\n    \r\n    if (!studentId) return;\r\n    \r\n    setLoading(true);\r\n    \r\n    try {\r\n      // Try to get actual data from API\r\n      const response = await axios.get(`/api/attendance/student/${studentId}`, {\r\n        headers: {\r\n          Authorization: `Bearer ${localStorage.getItem('token')}`\r\n        },\r\n        params: {\r\n          year: filters.year,\r\n          month: filters.month\r\n        }\r\n      });\r\n      \r\n      if (response.data?.data) {\r\n        // Format real data\r\n      } else {\r\n        // Generate mock data for development\r\n      }\r\n    } catch (error) {\r\n      console.error(\"Error fetching student attendance:\", error);\r\n      // Generate mock data for selected student\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, [filters.year, filters.month]);\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg shadow p-6\">\r\n        {/* Header with title and export button */}\r\n        <div className=\"flex flex-col md:flex-row md:items-center md:justify-between mb-6\">\r\n          <h2 className=\"text-2xl font-bold text-gray-900 dark:text-white mb-4 md:mb-0\">\r\n            {L.analysis}\r\n          </h2>\r\n          <div className=\"flex gap-2\">\r\n            <button\r\n              onClick={handleExportCSV}\r\n              className=\"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 transition-colors\"\r\n              disabled={!attendanceData.length}\r\n            >\r\n              {L.exportCSV}\r\n            </button>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Filters */}\r\n        <div className=\"grid grid-cols-1 md:grid-cols-5 gap-4 mb-6\">\r\n          <div>\r\n            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n              {L.month}\r\n            </label>\r\n            <select\r\n              name=\"month\"\r\n              value={filters.month}\r\n              onChange={e => setFilters(f => ({ ...f, month: Number(e.target.value) }))}\r\n              className=\"w-full px-3 py-2 border rounded focus:outline-none focus:ring focus:border-blue-300 dark:bg-gray-700 dark:text-white dark:border-gray-600\"\r\n            >\r\n              {getMonthNames().map((month, idx) => (\r\n                <option key={idx} value={idx + 1}>\r\n                  {month}\r\n                </option>\r\n              ))}\r\n            </select>\r\n          </div>\r\n          <div>\r\n            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n              {L.year}\r\n            </label>\r\n            <select\r\n              name=\"year\"\r\n              value={filters.year}\r\n              onChange={e => setFilters(f => ({ ...f, year: Number(e.target.value) }))}\r\n              className=\"w-full px-3 py-2 border rounded focus:outline-none focus:ring focus:border-blue-300 dark:bg-gray-700 dark:text-white dark:border-gray-600\"\r\n            >\r\n              {[...Array(5)].map((_, i) => (\r\n                <option key={i} value={new Date().getFullYear() - i}>\r\n                  {new Date().getFullYear() - i}\r\n                </option>\r\n              ))}\r\n            </select>\r\n          </div>\r\n          <div>\r\n            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n              {L.class}\r\n            </label>\r\n            <select\r\n              name=\"classCode\"\r\n              value={filters.classCode}\r\n              onChange={e => setFilters(f => ({ ...f, classCode: e.target.value }))}\r\n              className=\"w-full px-3 py-2 border rounded focus:outline-none focus:ring focus:border-blue-300 dark:bg-gray-700 dark:text-white dark:border-gray-600\"\r\n            >\r\n              <option value=\"\">{L.all}</option>\r\n              <option value=\"ADH\">{CLASS_LABELS.ADH[currentLang]}</option>\r\n              <option value=\"MET\">{CLASS_LABELS.MET[currentLang]}</option>\r\n              <option value=\"KHA\">{CLASS_LABELS.KHA[currentLang]}</option>\r\n              <option value=\"NEK\">{CLASS_LABELS.NEK[currentLang]}</option>\r\n            </select>\r\n          </div>\r\n          <div className=\"md:col-span-2\">\r\n            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n              {L.search}\r\n            </label>\r\n            <input\r\n              type=\"text\"\r\n              value={filters.searchTerm}\r\n              onChange={e => setFilters(f => ({ ...f, searchTerm: e.target.value }))}\r\n              placeholder={L.searchPlaceholder}\r\n              className=\"w-full px-3 py-2 border rounded focus:outline-none focus:ring focus:border-blue-300 dark:bg-gray-700 dark:text-white dark:border-gray-600\"\r\n            />\r\n          </div>\r\n        </div>\r\n\r\n        {/* Student Filter */}\r\n        {filteredStudents.length > 0 && (\r\n          <div className=\"mb-6\">\r\n            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n              {L.selectStudent}\r\n            </label>\r\n            <select\r\n              value={selectedStudent}\r\n              onChange={e => handleStudentSelect(e.target.value)}\r\n              className=\"w-full px-3 py-2 border rounded focus:outline-none focus:ring focus:border-blue-300 dark:bg-gray-700 dark:text-white dark:border-gray-600\"\r\n            >\r\n              <option value=\"\">{L.all}</option>\r\n              {filteredStudents.map(student => (\r\n                <option key={student._id} value={student._id}>\r\n                  {student.studentId} - {student.name[currentLang]}\r\n                </option>\r\n              ))}\r\n            </select>\r\n          </div>\r\n        )}\r\n\r\n        {/* Error/Loading */}\r\n        {error && (\r\n          <div className=\"p-3 mb-4 bg-red-100 text-red-700 dark:bg-red-900 dark:text-red-300 rounded\">\r\n            {error}\r\n          </div>\r\n        )}\r\n        {loading && (\r\n          <div className=\"flex justify-center items-center p-8\">\r\n            <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500\"></div>\r\n          </div>\r\n        )}\r\n\r\n        {/* Class-wise Summary */}\r\n        <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6\">\r\n          {classSummary.map((cls) => (\r\n            <div key={cls.code} className=\"bg-blue-50 dark:bg-blue-900 p-4 rounded-lg\">\r\n              <h3 className=\"text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n                {cls.label}\r\n              </h3>\r\n              <p className=\"text-lg font-semibold text-blue-800 dark:text-blue-200\">\r\n                {cls.total} {L.students}\r\n              </p>\r\n              <p className=\"text-sm text-green-700 dark:text-green-300\">\r\n                {L.attendanceRate}: {cls.percent}%\r\n              </p>\r\n            </div>\r\n          ))}\r\n        </div>\r\n\r\n        {/* Attendance Trend Chart */}\r\n        <div className=\"mb-8\">\r\n          <h3 className=\"text-lg font-medium text-gray-900 dark:text-white mb-4\">\r\n            {L.trend}\r\n          </h3>\r\n          <div style={{ width: '100%', height: 250 }}>\r\n            <ResponsiveContainer>\r\n              <LineChart data={attendanceData}>\r\n                <CartesianGrid strokeDasharray=\"3 3\" />\r\n                <XAxis dataKey=\"date\" tickFormatter={d => new Date(d).getDate()} />\r\n                <YAxis domain={[0, 100]} tickFormatter={v => `${v}%`} />\r\n                <Tooltip formatter={v => `${v}%`} labelFormatter={d => new Date(d).toLocaleDateString(currentLang)} />\r\n                <Line type=\"monotone\" dataKey=\"attendanceRate\" stroke=\"#10b981\" strokeWidth={2} dot />\r\n              </LineChart>\r\n            </ResponsiveContainer>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Daily Breakdown & Attendance Rate */}\r\n        <div className=\"mb-8 grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n          <div>\r\n            <h3 className=\"text-lg font-medium text-gray-900 dark:text-white mb-4\">\r\n              {L.dailyBreakdown}\r\n            </h3>\r\n            <div style={{ width: '100%', height: 250 }}>\r\n              <ResponsiveContainer>\r\n                <BarChart data={attendanceData}>\r\n                  <CartesianGrid strokeDasharray=\"3 3\" />\r\n                  <XAxis dataKey=\"date\" tickFormatter={d => new Date(d).getDate()} />\r\n                  <YAxis />\r\n                  <Tooltip />\r\n                  <Legend />\r\n                  <Bar dataKey=\"present\" fill=\"#10b981\" name={L.present} />\r\n                  <Bar dataKey=\"absent\" fill=\"#ef4444\" name={L.absent} />\r\n                  <Bar dataKey=\"late\" fill=\"#f59e42\" name={L.late} />\r\n                </BarChart>\r\n              </ResponsiveContainer>\r\n            </div>\r\n          </div>\r\n          <div>\r\n            <h3 className=\"text-lg font-medium text-gray-900 dark:text-white mb-4\">\r\n              {L.attendanceRate}\r\n            </h3>\r\n            <div style={{ width: '100%', height: 250 }}>\r\n              <ResponsiveContainer>\r\n                <PieChart>\r\n                  <Pie\r\n                    data={pieData}\r\n                    dataKey=\"value\"\r\n                    nameKey=\"name\"\r\n                    cx=\"50%\"\r\n                    cy=\"50%\"\r\n                    outerRadius={80}\r\n                    label\r\n                  >\r\n                    {pieData.map((entry, idx) => (\r\n                      <Cell key={`cell-${idx}`} fill={COLORS[idx % COLORS.length]} />\r\n                    ))}\r\n                  </Pie>\r\n                  <Legend />\r\n                </PieChart>\r\n              </ResponsiveContainer>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Calendar View for Sundays/Poya/Flower Days */}\r\n        <div className=\"mb-8\">\r\n          <h3 className=\"text-lg font-medium text-gray-900 dark:text-white mb-4\">\r\n            {L.sundays} / {L.poya} / {L.flower} - {getMonthNames()[filters.month-1]} {filters.year}\r\n          </h3>\r\n          <div className=\"flex flex-wrap gap-2\">\r\n            {getSundaysInMonth(filters.month, filters.year).map((sunday, index) => {\r\n              const date = sunday.toISOString().split('T')[0];\r\n              const dayData = attendanceData.find(d => d.date === date) || { attendanceRate: 0 };\r\n              const isPoya = dayData.isPoya;\r\n              const isFlower = dayData.isFlowerDay;\r\n              \r\n              return (\r\n                <div \r\n                  key={`${date}-${index}`} // Added index to ensure unique keys\r\n                  className={`rounded-lg shadow p-4 w-36 ${\r\n                    isPoya ? 'bg-yellow-100 dark:bg-yellow-900' :\r\n                    isFlower ? 'bg-pink-100 dark:bg-pink-900' :\r\n                    'bg-white dark:bg-gray-700'\r\n                  }`}\r\n                >\r\n                  <div className=\"text-center\">\r\n                    <div className=\"text-sm font-medium\">{sunday.getDate()}</div>\r\n                    <div className=\"text-xs text-gray-500\">\r\n                      {isPoya ? L.poyaDay : \r\n                       isFlower ? L.flower :\r\n                       L.sunday}\r\n                    </div>\r\n                    <div className=\"mt-2\">\r\n                      <div className=\"w-full bg-gray-200 rounded-full h-2\">\r\n                        <div\r\n                          className=\"bg-green-600 h-2 rounded-full\"\r\n                          style={{ width: `${dayData.attendanceRate}%` }}\r\n                        ></div>\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"mt-1 text-sm font-medium\">\r\n                      {dayData.attendanceRate}%\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              );\r\n            })}\r\n            \r\n            {getSundaysInMonth(filters.month, filters.year).length === 0 && (\r\n              <div className=\"text-center p-6 text-gray-500 dark:text-gray-400 bg-gray-50 dark:bg-gray-900 rounded w-full\">\r\n                {L.noSundaysInMonth}\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        {/* Flower Offering Participation */}\r\n        <div className=\"mb-8\">\r\n          <h3 className=\"text-lg font-medium text-gray-900 dark:text-white mb-4\">\r\n            {L.flowerParticipation}\r\n          </h3>\r\n          {flowerData.length === 0 ? (\r\n            <div className=\"text-center p-6 text-gray-500 dark:text-gray-400 bg-gray-50 dark:bg-gray-900 rounded\">\r\n              {L.noData}\r\n            </div>\r\n          ) : (\r\n            flowerData.map((day, idx) => (\r\n              <div key={`flower-${day.date}-${idx}`} className=\"mb-4\">\r\n                <div className=\"font-semibold mb-2\">\r\n                  {new Date(day.date).toLocaleDateString(currentLang)} ({L.flower})\r\n                </div>\r\n                <div className=\"overflow-x-auto\">\r\n                  <table className=\"min-w-full bg-white dark:bg-gray-800 rounded\">\r\n                    <thead>\r\n                      <tr>\r\n                        <th className=\"px-2 py-1 text-left text-xs font-medium\">{L.student}</th>\r\n                        <th className=\"px-2 py-1 text-left text-xs font-medium\">{L.flowerType}</th>\r\n                        <th className=\"px-2 py-1 text-left text-xs font-medium\">{L.status}</th>\r\n                      </tr>\r\n                    </thead>\r\n                    <tbody>\r\n                      {day.participation.map((stu, index) => (\r\n                        <tr key={`${stu.studentId || ''}-${index}`}>\r\n                          <td className=\"px-2 py-1 text-xs\">{stu.name} ({stu.studentId})</td>\r\n                          <td className=\"px-2 py-1 text-xs\">{stu.flowerType || '-'}</td>\r\n                          <td className=\"px-2 py-1 text-xs\">\r\n                            {stu.brought ? L.brought : L.notBrought}\r\n                          </td>\r\n                        </tr>\r\n                      ))}\r\n                    </tbody>\r\n                  </table>\r\n                </div>\r\n              </div>\r\n            ))\r\n          )}\r\n        </div>\r\n\r\n        {/* Individual Student Analysis */}\r\n        {selectedStudent && (\r\n          <div className=\"mb-8\">\r\n            <h3 className=\"text-lg font-medium text-gray-900 dark:text-white mb-4\">\r\n              {L.individualAnalysis}\r\n            </h3>\r\n            <div className=\"overflow-x-auto rounded-lg shadow\">\r\n              <table className=\"min-w-full bg-white dark:bg-gray-800\">\r\n                <thead>\r\n                  <tr>\r\n                    <th className=\"px-4 py-2 text-left text-sm font-medium\">{L.date}</th>\r\n                    <th className=\"px-4 py-2 text-left text-sm font-medium\">{L.present}</th>\r\n                    <th className=\"px-4 py-2 text-left text-sm font-medium\">{L.absent}</th>\r\n                    <th className=\"px-4 py-2 text-left text-sm font-medium\">{L.late}</th>\r\n                  </tr>\r\n                </thead>\r\n                <tbody>\r\n                  {attendanceData.map((day, idx) => (\r\n                    <tr key={`${day.date}-${idx}`}>\r\n                      <td className=\"px-4 py-2 text-sm\">\r\n                        {new Date(day.date).toLocaleDateString(currentLang)}\r\n                      </td>\r\n                      <td className=\"px-4 py-2 text-sm\">{Math.random() > 0.2 ? '1' : '0'}</td>\r\n                      <td className=\"px-4 py-2 text-sm\">{Math.random() > 0.8 ? '1' : '0'}</td>\r\n                      <td className=\"px-4 py-2 text-sm\">{Math.random() > 0.9 ? '1' : '0'}</td>\r\n                    </tr>\r\n                  ))}\r\n                </tbody>\r\n              </table>\r\n            </div>\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default AttendanceAnalysis;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}